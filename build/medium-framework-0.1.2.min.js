!function(t,e,n){"function"==typeof define&&define.amd?define(function(){return t[n]=e()}):"object"==typeof module&&module.exports?module.exports=t[n]=e():t[n]=e()}(this,function(){var t=!0;return function(){var e,n,i,r,o,s,a,c,u,f,p,l,d;e=function(){var t,e,n={},i={init:function(t){console.log("init:",window._?"LODASH/UNDERSCORE!":"(no lodash/underscore)"),n=t||window._||n,e.extend(e,n)},clone:function(t,n,r,o,s){n=n||(e.isArray(t)?[]:{}),o=o||e.noop;for(var a in t)!t.hasOwnProperty(a)||s&&!e.isUndefined(n[a])||(n[a]=r&&e.isObject(t[a])?i.clone(t[a],null,!0):o(t[a],a,n));return n},cloneDeep:function(t,e,n){return i.clone(t,e,!0,n)},cookie:function(t){var e=document.cookie.match("(^|;)\\s*"+t+"\\s*=\\s*([^;]+)");return e?e.pop():""},defaults:function(t,e,n){return i.clone(e,t,!!n,null,!0)},defaultsDeep:function(t,e){return i.defaults(t,e,!0)},each:function(t,n,i){if(e.isArray(t))t.forEach(n.bind(i||window));else for(var r in t)n.bind(i||window)(t[r],r,t)},extend:function(t,e,n){return i.clone(e,t,!!n)},filter:function(t,e,n){var r=[];for(var o in t)if(i.isEqual(t[o],e,o)&&(r.push(t[o]),n))break;return n?r[0]:r},find:function(t,n){return e.filter(t,n,!0)},findWhere:function(t,n){return e.find(t,n)},get:function(t,n,i){var r=t.hasOwnProperty(n)?[n]:e.isArray(n)?n:n.split(/[\[\].:]+/);return r.reduce(function(t,n){return t===i||e.isUndefined(t[n])?i:t[n]},t)},getProp:function(t,n){var i=e.isArray(n)?n:n.split(":"),r=i.slice(-1)[0],o={};return o[r]=e.get(t,i.join(".")),o},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isBoolean:function(t){return"boolean"==typeof t},isDomSelection:function(t){return e.isNodeList(t)||e.isNode(t)||e.isJquery(t)},isEqual:function(t,n,r){if(!e.isObject(t)&&typeof t!=typeof n)return!1;if(e.isBoolean(n))return!!t===n;if(e.isFunction(n))return n(t,isNaN(r)?r:+r);if(e.isObject(n)){for(var o in n)if(n.hasOwnProperty(o)&&(!t.hasOwnProperty(o)||!i.isEqual(t[o],n[o])))return!1;return!0}return e.isObject(t)?t[n]:t===n},isFunction:function(t){return"function"==typeof t},isIE:function(){return"function"==typeof ScriptEngineMajorVersion?ScriptEngineMajorVersion():void 0}(),isJquery:function(t){return window.jQuery&&t instanceof window.jQuery},isNode:function(t){return"[object HTMLElement]"===Object.prototype.toString.call(t)},isNodeList:function(t){return"[object NodeList]"===Object.prototype.toString.call(t)},isObject:function(t,e){return e?"[object Object]"===Object.prototype.toString.call(t):"object"==typeof t},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t},isUndefined:function(t){return"undefined"==typeof t},noop:function(t){return t},object:function(t,n){var i=e.isArray(t[0]);return t.reduce(function(t,e,r){return t[i?e[0]:e]=i?e[1]:n[r],t},{})},omit:function(t,n){return e.pick2(t,e.isArray(n)?n:e.toArray(arguments).slice(1),!0)},pick:function(t,n){return e.pick2(t,e.isArray(n)?n:e.toArray(arguments).slice(1))},pick2:function(t,e,n){return Object.keys(t).reduce(function(i,r){var o=e.indexOf(r)>=0;return(o&&!n||!o&&n)&&(i[r]=t[r]),i},{})},randomString:function(t){return Array(t+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,t)},template:function(n){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"',$1,'").replace(/{{(.+?)}}/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');"):t[n]=t[n]||this.template($(n)[0].innerHTML);return function(t){return i(e.defaults(t,{_:e}))}},toArray:function(t){return[].slice.call(t)},serialise:function(t,e){var n=[];for(var i in t)if(t.hasOwnProperty(i)){var r=e?e+"["+i+"]":i,o=t[i];n.push("object"==typeof o?this.serialise(o,r):encodeURIComponent(r)+"="+encodeURIComponent(o))}return n.join("&")},uniq:function(t){return t.filter(function(t,e,n){return n.indexOf(t)===e})}};e={};for(var r in i)!function(t){Object.defineProperty(e,t,{get:function(){return n[t]||i[t]}})}(r);return e}(),n=function(t){var e={$event:window,props:{},data:{},init:function(n,i){this.props.hasOwnProperty(n)||(this.data[n]={},this.props[n]={});var r=this.props[n],o=this.data[n],s={on:function(i,r){return t.each(i.split(" "),function(t){return":"===t.slice(0,1)?e.on(e.event(t.slice(1)),r):void e.on(e.event(n,t),r)}),s},off:function(i){return t.each(i.split(" "),function(t){t=":"===t.slice(0,1)?e.event(t.slice(1)):e.event(n,i),e.off(t)}),s},get:function(n){return":"===n.slice(0,1)?e.get(n.slice(1)):n.split(":").reduce(function(e,n){return t.isUndefined(e)?e:e[n]},o)},set:function(n,i,a){t.isString(n)?n=t.object([n],[i]):a=i;return t.each(n,function(n,i){if(":"===i.slice(0,1))return e.get(i.slice(1),n,a);var c,u=i.split(":"),f=u.shift(),p=u.length?t.isObject(o[f])?o[f]:{}:n;o.hasOwnProperty(f)||(a!==!0&&(c=!1),Object.defineProperty(r,f,{enumerable:!0,configurable:!0,get:function(){return o[f]},set:function(t){o[f]!==t&&(o[f]=t,s.trigger(f))}})),u.length?u.reduce(function(e,i,r){return r+1<u.length?(t.isObject(e[i])||(e[i]={}),e[i]):(t.isUndefined(e)&&(e={}),t.isUndefined(c)&&(c=e[i]!==n),e[i]=n,void 0)},p):t.isUndefined(c)&&(c=o[f]!==p),o[f]=p,(a===!0||c&&a!==!1)&&s.trigger(i)}),s},trigger:function(i){t.isString(i)&&(i=[i]);var r=t.toArray(arguments).slice(1);return t.each(i,function(i){t.each(i.split(":"),function(i,a,c){var u=c.slice(0,c.length-a),f=u.join(":"),p=t.getProp(o,u),l=r.length?r:[p[u.slice(-1)[0]]],d=":"===f.slice(0,1)?e.event(f.slice(1)):e.event(n,f);l=1===l.length?l.concat(p,s):l.concat(s),e.$event.trigger(d,l)})}),s},unset:function(i){t.isString(i)&&(i=[i]),t.each(i,function(t){var i=t.split(":"),r=""===i[0]?i[1]:n,o=""===i[0]?i[2]:i[0];delete e.data[r][o]})},props:r,raw:o};return t.isObject(i)&&s.set(i,!1),s},get:function(e,n,i){if(!(e.indexOf(":")<=0)){var r=e.split(":"),o=this.init(r[0]),s=r.slice(1).join(":");return t.isUndefined(n)||o.set(s,n,i),o.get(s)}},on:function(n,i){return!e.$event.on&&window.jQuery&&(e.$event=window.jQuery(window)),t.each(n.split(" "),function(n){e.$event.on(e.event(n),function(){t.isFunction(i)&&i.apply(this,t.toArray(arguments).slice(1))})}),e},off:function(n,i){return t.each(n.split(" "),function(t){i?e.$event.off(e.event(t),i):e.$event.off(e.event(t))}),e},event:function(e){return"app-props:"+t.toArray(arguments).join(":").replace(/app-props:/g,"")}};return e}(e),i=function(t){var e={fn:{init:function(){Node.prototype.removeAttr=NodeList.prototype.removeAttr=e.fn.removeAttr,Node.prototype.attr=NodeList.prototype.attr=e.fn.attr,Node.prototype.data=NodeList.prototype.data=e.fn.data},removeAttr:function(t){return this.forEach(function(e){e.removeAttribute(t)}),this},attr:function(n,i){var r=t.toArray(arguments);return r.length>2&&(r.length=2),e.fn.set.apply(this,r)},data:function(n,i){if(1===arguments.length&&t.isString(n))return e.fn.set.call(t.isNodeList(this)?this[0]:this,n,void 0,!0);var r={};return t.isObject(n)?t.extend(r,n,!0):r[n]=i,e.fn.set.call(this,r,void 0,!0),this},set:function(n,i,r){if(t.isNodeList(this))return 1===arguments.length&&t.isString(n)?this[0]?this[0].getAttribute(n):void 0:(this.forEach(function(t){e.fn.set.apply(t,this)}.bind(arguments)),this);if(r&&!this._dataset&&(this._dataset=t.cloneDeep(this.dataset)),1===arguments.length||r&&t.isUndefined(i)){if(t.isString(n))return r?this._dataset[n]:this.getAttribute(n);for(var o in n)r?this._dataset[o]=n[o]:this.setAttribute(o,n[o])}else r?this._dataset[n]=i:this.setAttribute(n,i);return this}}};return e.fn}(e),r=function(t){var e={fn:{init:function(){Node.prototype.addClass=NodeList.prototype.addClass=e.fn.add,Node.prototype.removeClass=NodeList.prototype.removeClass=e.fn.remove,Node.prototype.toggleClass=NodeList.prototype.toggleClass=e.fn.toggle,Node.prototype.hasClass=NodeList.prototype.hasClass=e.fn.contains},get:function(){return this.reduce(function(e,n){return e.concat(t.toArray(n.classList))},[])},set:function(n,i,r,o){return t.isNodeList(n)?n.forEach(function(t){o?o.apply(t,r):e.fn.set(t,i,this)}.bind(r)):t.toArray(r).join(" ").split(" ").forEach(function(t){n.classList[i](t)}),n},add:function(){return e.fn.set(this,"add",arguments)},remove:function(){return e.fn.set(this,"remove",arguments)},toggle:function(n,i){return e.fn.set(this,"add",arguments,function(){t.isIE?(t.isUndefined(i)?this.classList.contains(n):i)?this.classList.add(n):this.classList.remove(n):this.classList.toggle(n,i)})},contains:function(e,n){if(t.isNodeList(this)){var i;return this.forEach(function(t,r){t.classList.contains(e)?n&&i!==!1?i=!0:n||(i=!0):n&&(i=!1)}),!!i}return this.classList.contains(e)}}};return e.fn}(e),o=function(t){var e={types:{DragEvent:["drag","dragend","dragenter","dragleave","dragover","dragstart","drop"],Event:["change","input","invalid"],FocusEvent:["blur","focus"],KeyboardEvent:["keydown","keypress","keyup"],MouseEvent:["click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"],TouchEvent:["touchcancel","touchend","touchenter","touchleave","touchmove","touchstart"],WheelEvent:["wheel"]},list:[],data:{},fn:{init:function(){NodeList.prototype.on=NodeList.prototype.addEventListener=e.fn.on.all,Node.prototype.on=window.on=e.fn.on.event,XMLHttpRequest.prototype.on=e.fn.on.xhr,NodeList.prototype.off=NodeList.prototype.removeEventListener=e.fn.off.all,Node.prototype.off=window.off=XMLHttpRequest.prototype.off=e.fn.off.event,NodeList.prototype.trigger=e.fn.trigger.all,Node.prototype.trigger=window.trigger=e.fn.trigger.event,e.types.list={ref:{}};for(var t in e.types)"list"!==t&&e.types[t].forEach(function(n){e.types.list[n]=window[t],e.types.list.ref[n]=t})},on:{all:function(t,e,n){return this.forEach(function(i){i.on(t,e||n,e?n:!1)}),this},event:function(n,i,r){return n.split(" ").forEach(function(n){var o=e.fn.type.e(n),s=e.fn.type.ns(n),a=function(n){var o=r?(n.delegateTarget=n.target.closest(i))?n.target:!1:this,s=n.detail||n.data,a=e.data[s];o&&(n.detail=0,(r||i).apply(o,a?t.toArray(arguments).concat(a):arguments))};e.list.push({$el:this,type:o,ns:s,fn:r||i,callback:a}),this.addEventListener(o,a)}.bind(this)),this},xhr:function(t,n){return e.fn.on.el.call(this,t,n),this}},off:{all:function(t,e){return this.forEach(function(t){t.off.apply(t,this)}.bind(arguments)),this},event:function(n,i){return i=arguments.length>1?i||!0:!1,n.split(" ").forEach(function(n){if(n){var r=e.fn.type.e(n),o=e.fn.type.ns(n),s=t.filter(e.list,function(t,e){return t.i=e,t.$el===this?!(r&&t.type!==r||o&&t.ns!==o||i&&t.fn!==i):void 0}.bind(this));for(var a in s)e.list.splice(s[a].i,1),this.removeEventListener(s[a].type,s[a].callback)}}.bind(this)),this}},trigger:{all:function(t,e){return this.forEach(function(n){n.trigger(t,e)}),this},event:function(n,i){var r,o=+Math.random().toString().slice(2,11);e.data[o]=i,t.isIE?(r=document.createEvent(e.types.list.ref[n]||"Event"),r.initEvent(n,!0,!1),r.data=o,this.dispatchEvent(r)):(r=e.types.list[n]||CustomEvent,this.dispatchEvent(new r(n,{bubbles:!0,detail:o}))),delete e.data[o]}},type:{e:function(t){return t.replace(/\..*/,"")},ns:function(t){return t.replace(/^[^.]*\.?/,"")}}}};return e.fn}(e),s=function(t){var e={fn:{init:function(){Node.prototype.find=window.find=NodeList.prototype.find=e.fn.find,Node.prototype.parents=NodeList.prototype.parents=e.fn.parents,Node.prototype.path=NodeList.prototype.path=e.fn.path,Node.prototype.closest=NodeList.prototype.closest=e.fn.closest},find:function(e){if(t.isNodeList(this)){var n="f"+(1e5*Math.random()|0);this.forEach(function(t){t.find(e).forEach(function(t){t.classList.add(n)})});var i=document.querySelectorAll("."+n);return i.forEach(function(t){t.classList.remove(n)}),i}var r=this===window?document:this;return r.querySelectorAll(e)},parents:function(e){if(t.isNodeList(this))return this.length>1?t.uniq(this.reduce(function(t,n){return t.concat(n.parents.call(this,e))},[])):this.parents.call(this[0],e);var n=this.path().slice(1);return e?n.filter(function(t){return t.is(e)}):n},path:function(e){if(t.isNodeList(this))return this.map(function(t){return t.path(e)});if(!this.$path||e){var n=this;for(this.$path=[];n&&n!==document;n=n.parentNode)this.$path.push(n)}return this.$path.slice()},closest:function(e){return e?t.isNodeList(this)?this.length>1?t.uniq(this.reduce(function(t,n){return t.concat(n.closest.call(this,e))},[])):this.closest.call(this[0],e):t.find(this.path(),function(t){return t.is(e)}):[]}}};return e.fn}(e),a=function(t){var e={fn:{init:function(){NodeList.prototype.eq=e.fn.eq,Node.prototype.is=NodeList.prototype.is=e.fn.is,Node.prototype.clone=NodeList.prototype.clone=e.fn.clone,Node.prototype.before=NodeList.prototype.before=e.fn.before,Node.prototype.after=NodeList.prototype.after=e.fn.after,Node.prototype.prepend=NodeList.prototype.prepend=e.fn.prepend,Node.prototype.append=NodeList.prototype.append=e.fn.append,Node.prototype.text=NodeList.prototype.text=e.fn.text,Node.prototype.html=NodeList.prototype.html=e.fn.html,Node.prototype.val=NodeList.prototype.val=e.fn.val,Node.prototype.prop=NodeList.prototype.prop=e.fn.prop},el:function(n,i,r){if(t.isNodeList(n))n.forEach(function(t){e.fn.el(t,i,r)});else if(t.isString(r))return n.insertAdjacentHTML(i,r)},eq:function(t){return this[t]},is:function(e){var n=t.isNodeList(this)?this:[this];return n.reduce(function(n,i){return n||(t.isString(e)?t.isIE||i.msMatchesSelector?i.msMatchesSelector(e):i.matches(e):t.isNodeList(e)?e.is(i):e===i)},!1)},clone:function(){if(t.isNodeList(this)){var e=document.createDocumentFragment();return this.forEach(function(t){var n=t.cloneNode(!0);e.appendChild(n)}),e.childNodes}return this.cloneNode(!0)},val:function(t){return this.prop("value",t)},prop:function(e,n){var i=t.isNodeList(this)?this:[this];return 1===arguments.length&&t.isString(e)?(n=i[0]?i[0][e]:void 0,"true"===n?!0:"false"===n?!1:n):(t.isString(e)&&(e=t.object([e],[n])),i.forEach(function(t){for(var n in e)t[n]=e[n]}),this)},before:function(t){return e.fn.el(this,"beforebegin",t),this},after:function(t){return e.fn.el(this,"afterend",t),this},prepend:function(t){return e.fn.el(this,"afterbegin",t),this},append:function(t){return e.fn.el(this,"beforeend",t),this},text:function(e,n){var i=t.isNodeList(this)?this:[this];if(t.isUndefined(e)){var r;return i.reduce(function(t,e,o){var s=e[n?"innerHTML":"textContent"];return r=0===o||s===r?s:!1,o===i.length-1&&r?r:t+s},"")}return i.forEach(function(t){t[n?"innerHTML":"textContent"]=e}),this},html:function(t){return this.text(t,!0)}}};return e.fn}(e),c=function(t,e,n,i,r,o){var s={init:function(){o.init(),window.jQuery||(this.init=o.noop,window.$=function(t){return o.isString(t)?document.querySelectorAll(t):t},NodeList.prototype.__proto__=Array.prototype,t.init(),e.init(),n.init(),i.init(),r.init())}};return s}(i,r,o,s,a,e),u=function(t){var e={get:function(e){return e.type="GET",e.url=e.url||"",e.data&&(e.data=t.isString(e.data)?e.data:t.serialise(e.data),e.url+=(e.url.indexOf("?")>=0?"&":"?")+e.data),this.request(e)},post:function(t){return t.type="POST",t.url=t.url||"",this.request(t)},request:function(e){var n=new XMLHttpRequest;return type=e.type||"GET",callback=function(e,i,r){if(t.isFunction(e)){if(r||(r=i,i=r.target.response),t.isString(i)&&/\[|\{/.test(i.slice(0,1))||!isNaN(i))try{i=JSON.parse(i)}catch(r){}e(i,r,n)}},n.addEventListener("load",function(t){200!==t.target.status&&callback(e.error,t),callback(e.complete,t)}),n.addEventListener("progress",function(t){callback(e.progress,t.lengthComputable?t.loaded/t.total:void 0,t)}),n.addEventListener("error",function(t){callback(e.error,t)}),n.addEventListener("abort",function(t){callback(e.abort,t)}),n.open(type,e.url),"GET"!==type&&e.data?(e.header!==!1&&n.setRequestHeader("Content-Type",e.header||"application/json;charset=UTF-8"),n.send(t.isString(e.data)?e.data:JSON.stringify(e.data))):n.send(),n}};return e}(e),f=function(t,e,n,i){var r={extend:function(r){if(e.init(),r.name){var o=t.init(r.name,r.props);n.extend(r,o),n.each(n.omit(o,"props"),function(t,e){Object.defineProperty(r,e,{enumerable:!1,value:t})})}else console.warn("A view/module is unnamed - it will be unable to communicate:\r",r);return Object.defineProperty(r,"_fn",{enumerable:!1,value:n.cloneDeep(r.fn)}),Object.defineProperty(r,"XHR",{enumerable:!1,value:i}),Object.defineProperty(r,"_",{enumerable:!1,value:n}),r.Props=t,this.wrap(r.fn,r)},wrap:function(t,e){return n.each(t,function(i,o){!n.isObject(i)||n.isFunction(i)||n.isNodeList(i)||n.isJquery(i)?n.isFunction(i)&&(t[o]=function(t){return i.apply(e,arguments)}):r.wrap(i,e)}),t}};return r}(n,c,e,u),p=function(t,e){var n={extend:function(i){var r=t.extend(i);return i.uid||(i.uid=e.randomString(16)),i.bind=n.$el.bind.bind(i),i.unbind=n.$el.unbind.bind(i),i.autoBind=n.$el.autoBind.bind(i),n.$el.set(i),r},$el:{set:function(t){return t.el=t.el||"body",t.$el=e.isString(t.el)?$(t.el):e.isDomSelection(t.el)?t.el:e.isString(t.el.selector)?$(t.el.selector):!1,t.$el?void 0:console.warn('View "'+t.name+'": element is incorrectly defined')},autoBind:function(t,n){n=n||":router",this.on(n+":"+(t||this.name),function(){(this.fn.render||e.noop).apply(this,arguments),this.bind()}.bind(this)),this.on(n+":before",this.unbind)},bind:function(){this.bindings&&this.unbind(),this.trigger("prebind"),this.bindings=[],e.each(this.el.bind,function(t,i){var r,o;if(e.isString(t)&&(t={selector:t}),t.selector)o={el:$(t.selector),prop:i,selector:t.selector,node:!0},this.set(o.prop,o.el,!1);else if(e.isObject(t)){r=$(i),o={input:r.is("input, textarea")||r.prop("contentEditable")===!0,prop:t.to,$el:r,selector:i,fn:function(n){o.$el.forEach(function(i){if(o.current!==i){var r=e.isFunction(s)?s(n,i,!0):n;e.isUndefined(r)||i.prop(t.set,r)}})}},t.set=t.set||(o.input?"value":"textContent");var s=t.fn?t.fn.split(":").reduce(function(t,n){return e.isObject(t)?t[n]:!1},this.fn):!1,a=e.isUndefined(t.val)?this.Props.get(this.name+":"+o.prop)||o.$el.prop(t.set):t.val;this.on(o.prop,o.fn),this.Props.get(this.name+":"+o.prop,a,!0),o.input&&this.$el.on(n.$el.event("input change",this),o.selector,function(n){o.current=n.target;var i=n.target[t.set],r=e.isFunction(s)?s(i,n.target,!1):i;this.set(o.prop,r),o.current=!1}.bind(this))}o&&t.on&&e.each(t.on,function(t,e){n.$el.fn(e,o.selector,t,this)},this),this.bindings.push(o)},this),e.each(this.el.on,function(t,e){n.$el.fn(e,!1,t,this)},this),this.trigger("bind")},fn:function(t,i,r,o){e.isObject(r)&&r.delegate&&r.fn&&(i=e.isString(i)?i+" "+r.delegate:r.delegate,r=r.fn),e.isString(r)&&(r=r.split(":").reduce(function(t,n){return e.isObject(t)?t[n]:!1},o.fn)),e.isFunction(r)&&(t=n.$el.event(t,o),r=r.bind(o),i?o.$el.on(t,i,r):o.$el.on(t,r))},unbind:function(){this.bindings&&(this.trigger("preunbind"),this.$el.off(".bind-"+(this.uid||this.name)),e.each(this.bindings,function(t){t.node?this.unset(t.prop):this.off(t.prop,t.fn)},this),this.bindings=!1,this.trigger("unbind"))},event:function(t,e){return t.replace(/( |$)/g,".bind-"+(e.uid||e.name)+"$1")}}};return n}(f,e),l=function(t,e){var n='<% if( obj.missing ){ %>Missing a BASE tag<% }else{ %>BASE tag is incorrect<% } %>. If this is a production site include the following below your <title>:\n<base href="<%= base %>">',i={extend:function(n){return e.defaultsDeep(n.fn,i.fn),n.start=function(){this.fn.start.apply(this,arguments)},t.extend(n)},fn:{start:function(t,i){window.onpopstate=function(t){t.state&&this.fn.route.href({href:t.state.href,replace:!0})}.bind(this);var r=$("head base"),o=this._.cookie("base");this.props.base=t||this.props.base||o||r.attr("href")||window.location.origin,0!==this.props.base.indexOf(location.origin)&&(this.props.base=location.origin+this.props.base),r.length?r.attr("href")!==this.props.base&&(r.attr("href",this.props.base),o||console.warn(e.template(n)({base:this.props.base}))):($("head title").after('<base href="'+this.props.base+'">'),o||console.warn(e.template(n)({base:this.props.base,missing:!0}))),this.props.title=$("head title").text(),e.each(this.props.routes,this.fn.route.set),this.on("href",this.fn.route.href),$("body").on("click","a:not([data-external])",this.fn.anchor),this.trigger("start"),this.set("href",{href:i||location.href.replace(this.props.base,""),replace:!0},!0)},anchor:function(t){if(0===t.delegateTarget.href.indexOf(this.props.base)){var e=t.delegateTarget,n=e.getAttribute("href").replace(/^\//,"");http="http"===e.href.slice(0,4),target=e.target||"_self","_self"!==target||"#"===n.slice(0,1)||!http||t.ctrlKey||t.metaKey||(t.preventDefault(),this.fn.route.href(n))}},route:{href:function(t){e.isString(t)?t={href:t}:this.set("href",t.href,!1);var n,i,r,o=t.href,s=[],a=e.find(this.props.routes,function(t){s=o.match(t.re);for(var e in s)s[e]=isNaN(s[e])?s[e]:+s[e];return s})||{};s||(s=[]),n=[a.name].concat(s.slice(1)),i=t.replace||[o,this.props.base+o].indexOf(window.location.href)>=0,r=t.trigger!==!1,r&&this.trigger.apply(this,["before"].concat(n)),window.history.pushState||window.open(o,"_self"),i?window.history.replaceState({href:o},a.title,o):window.history.pushState({href:o},a.title,o),document.title=a.title,$("body").attr("data-route",a.name),this.set("current",{href:o,name:a.name,args:s.slice(1)},r),r&&this.trigger.apply(this,n),r&&this.trigger.apply(this,["after"].concat(n))},set:function(t,n,i){e.isObject(t)||(t={route:t}),t.name=n,t.title=(t.title||n.slice(0,1).toUpperCase()+n.slice(1))+(this.props.delimeter||" | ")+this.props.title,t.re=t.re||e.isRegExp(t.route)?t.route:this.fn.route.re(t.route),i[n]=t},re:function(t){var e={optional:/\((.*?)\)/g,named:/(\(\?)?:\w+/g,path:/\*\w+/g,escape:/[\-{}\[\]+?.,\\\^$|#\s]/g};return t=t.replace(e.escape,"\\$&").replace(e.optional,"(?:$1)?").replace(e.named,function(t,e){return e?t:"([^/?]+)"}).replace(e.path,"([^?]*?)"),new RegExp("^"+t+"(?:\\?[\\s\\S]*)?$")}}}};return i}(f,e),d=function(e,n,i,r,o,s){var a={version:"0.1.2",View:e,Module:n,Router:i,Props:r,_:o,XHR:s};return"undefined"!=typeof t&&(t=a),a}(p,f,l,n,e,u)}(),t},"MediumFramework");
//# sourceMappingURL=medium-framework-0.1.2.min.js.map